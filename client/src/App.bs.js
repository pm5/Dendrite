// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Async from "./Async.bs.js";
import * as Curry from "bs-platform/lib/es6/curry.js";
import * as React from "react";
import * as $$Storage from "./Storage.bs.js";
import * as Belt_Option from "bs-platform/lib/es6/belt_Option.js";
import * as ReactNative from "react-native";
import * as StateProvider from "./StateProvider.bs.js";
import * as PairBeaconScreen from "./components/PairBeaconScreen.bs.js";

function App$StartScreen(Props) {
  var match = React.useContext(StateProvider.stateContext);
  var setAppState = match[1];
  return React.createElement(React.Fragment, undefined, React.createElement(ReactNative.View, {
                  children: null
                }, React.createElement(ReactNative.Text, {
                      children: "Start Screen"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* ScanningBeacon */1;
                                      }));
                        }),
                      title: "No beacon paired"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* NoUserStored */3;
                                      }));
                        }),
                      title: "No user data"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* Initializing */8;
                                      }));
                        }),
                      title: "All good to go"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          
                        }),
                      title: "Clear beacon data"
                    })));
}

var StartScreen = {
  make: App$StartScreen
};

function App$LoadUserScreen(Props) {
  var match = React.useContext(StateProvider.stateContext);
  var setAppState = match[1];
  var appState = match[0];
  React.useEffect((function () {
          if (typeof appState !== "number") {
            return ;
          }
          switch (appState) {
            case /* NoUserStored */3 :
                Curry._1(setAppState, (function (param) {
                        return /* DownloadingUser */4;
                      }));
                return ;
            case /* DownloadingUser */4 :
                Curry._1(setAppState, (function (param) {
                        return /* UserJustStored */7;
                      }));
                return ;
            case /* ErrorUserNotFound */5 :
                Curry._1(setAppState, (function (param) {
                        return /* BeaconUnpaired */2;
                      }));
                return ;
            case /* ErrorUserInvalid */6 :
                Curry._1(setAppState, (function (param) {
                        return /* BeaconUnpaired */2;
                      }));
                return ;
            case /* UserJustStored */7 :
                Curry._1(setAppState, (function (param) {
                        return /* Start */0;
                      }));
                return ;
            case /* Start */0 :
            case /* ScanningBeacon */1 :
            case /* BeaconUnpaired */2 :
            case /* Initializing */8 :
            case /* Monitoring */9 :
            case /* NearbyUserDetected */10 :
            case /* QueryingUser */11 :
            case /* WarningUser */12 :
                return ;
            
          }
        }), [appState]);
  return React.createElement(React.Fragment, undefined, React.createElement(ReactNative.View, {
                  children: React.createElement(ReactNative.Text, {
                        children: "Loading user data"
                      })
                }));
}

var LoadUserScreen = {
  make: App$LoadUserScreen
};

function App$MonitorScreen(Props) {
  var match = React.useContext(StateProvider.stateContext);
  var setAppState = match[1];
  var appState = match[0];
  React.useEffect((function () {
          if (typeof appState !== "number") {
            return ;
          }
          switch (appState) {
            case /* Initializing */8 :
                Curry._1(setAppState, (function (param) {
                        return /* Monitoring */9;
                      }));
                return ;
            case /* NearbyUserDetected */10 :
                Curry._1(setAppState, (function (param) {
                        return /* QueryingUser */11;
                      }));
                return ;
            case /* QueryingUser */11 :
                Curry._1(setAppState, (function (param) {
                        return /* Monitoring */9;
                      }));
                return ;
            case /* Start */0 :
            case /* ScanningBeacon */1 :
            case /* BeaconUnpaired */2 :
            case /* NoUserStored */3 :
            case /* DownloadingUser */4 :
            case /* ErrorUserNotFound */5 :
            case /* ErrorUserInvalid */6 :
            case /* UserJustStored */7 :
            case /* Monitoring */9 :
            case /* WarningUser */12 :
                return ;
            
          }
        }), [appState]);
  return React.createElement(React.Fragment, undefined, React.createElement(ReactNative.View, {
                  children: null
                }, React.createElement(ReactNative.Text, {
                      children: "Monitor"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* NearbyUserDetected */10;
                                      }));
                        }),
                      title: "Nearby found"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* WarningUser */12;
                                      }));
                        }),
                      title: "Danger found"
                    })));
}

var MonitorScreen = {
  make: App$MonitorScreen
};

function App$WarnScreen(Props) {
  var match = React.useContext(StateProvider.stateContext);
  var setAppState = match[1];
  return React.createElement(React.Fragment, undefined, React.createElement(ReactNative.View, {
                  children: null
                }, React.createElement(ReactNative.Text, {
                      children: "Warning!"
                    }), React.createElement(ReactNative.Button, {
                      onPress: (function (param) {
                          return Curry._1(setAppState, (function (param) {
                                        return /* Monitoring */9;
                                      }));
                        }),
                      title: "No danger anymore"
                    })));
}

var WarnScreen = {
  make: App$WarnScreen
};

function App$AppView(Props) {
  var match = React.useContext(StateProvider.stateContext);
  var state = match[0];
  var tmp;
  var exit = 0;
  if (typeof state === "number") {
    switch (state) {
      case /* Start */0 :
          tmp = React.createElement(App$StartScreen, {});
          break;
      case /* ScanningBeacon */1 :
      case /* BeaconUnpaired */2 :
          exit = 1;
          break;
      case /* NoUserStored */3 :
      case /* DownloadingUser */4 :
      case /* ErrorUserNotFound */5 :
      case /* ErrorUserInvalid */6 :
      case /* UserJustStored */7 :
          exit = 2;
          break;
      case /* Initializing */8 :
      case /* Monitoring */9 :
      case /* NearbyUserDetected */10 :
      case /* QueryingUser */11 :
          exit = 3;
          break;
      case /* WarningUser */12 :
          tmp = React.createElement(App$WarnScreen, {});
          break;
      
    }
  } else {
    exit = 1;
  }
  switch (exit) {
    case 1 :
        tmp = React.createElement(PairBeaconScreen.make, {});
        break;
    case 2 :
        tmp = React.createElement(App$LoadUserScreen, {});
        break;
    case 3 :
        tmp = React.createElement(App$MonitorScreen, {});
        break;
    
  }
  return React.createElement(React.Fragment, undefined, tmp);
}

var AppView = {
  make: App$AppView
};

function App$app(Props) {
  var match = React.useState(function () {
        return /* Start */0;
      });
  Async.then_($$Storage.loadBeacon(undefined), (function (b) {
          return Async.async(Belt_Option.map(b, (function (beacon) {
                            console.log(beacon.id);
                            
                          })));
        }));
  return React.createElement(React.Fragment, undefined, React.createElement(StateProvider.make, StateProvider.makeProps([
                      match[0],
                      match[1]
                    ], React.createElement(App$AppView, {}), undefined)));
}

var app = App$app;

export {
  StartScreen ,
  LoadUserScreen ,
  MonitorScreen ,
  WarnScreen ,
  AppView ,
  app ,
  
}
/* react Not a pure module */
